const cohere = require("cohere-ai");

const cohereApiKey = process.env.NEXT_PUBLIC_COHERE_API_KEY;

cohere.init(cohereApiKey);

export default async function remedy(req, res) {
  const response = await cohere.generate({
    model: "xlarge",
    // prompt:
    //   "Summary:  This person feels unsupported and alienated.\n\nResponse: This person feels unsupported and alienated. Ask about immediate danger before asking case-specific questions that suggest solutions. Offer professional mental health resources (therapy, healthcare provider(s)) and reaching out to trusted individuals. \n--\nSummary:  This person may be struggling with alcohol and financial instability.\n\nResponse: This person may be struggling with alcohol and financial instability. First ask about any immediate danger and if illegal substances / harm is in the vicinity. Remind them of personal worth and listen to their story.\n--\nSituation: This person is in danger / high risk situation.\n\nResponse: This person is in danger / high risk situation. Offer help from authorities, trauma centres, abuse helplines, social services; reassure them they are taking the right steps. Contact 911 if suspect of personal safety continues after this conversation.\n--\nSummary: This person poses a high risk to themselves.\n\nResponse: This person poses a high risk to themselves. Listen to their concerns and have them assessed by the appropriate healthcare professionals.\n--\nSummary: This person poses a high risk to themselves and may be at risk of suicide and/or self-harm.\n\nResponse: This person is in danger / high risk situation. Offer help from authorities, trauma centres, abuse helplines, social services; reassure them they are taking the right steps. Contact 911 if suspect of personal safety continues after this conversation.\n--\nSummary:  This person sounds overwhelmed by a distressing domestic environment.\n\nResponse: This person sounds overwhelmed by a distressing environment. Provide alternative living situations through social welfare and services; call authorities if domestic violence or harm is probable.\n--\nSummary:  This person is struggling with victimization.\n\nResponse: This person is struggling with victimization. Listen to their story and reassure them they are not alone. Find support for them from authorities, abuse helplines, social services and the appropriate healthcare.\n--\nSummary:  This person may be at risk of hurting someone in their immediate range.\n\nResponse: This person may be at risk of hurting someone in their immediate range. Acknowledge their feelings of injustice and validate their feelings. Aim to calm the person from their emotional distress. Reach out to authorities and seek emergency help if you sense continual danger.\n--\nSummary:  This person may be struggling with current financial situation(s) and may be in danger of neglecting their child.\n\nResponse: This person may be struggling with current financial situation(s) and may be in danger of neglecting their child. Offer familial and welfare resources, and potential social service help. Reassure them that they are not alone and offer counselling and child care.\n--\nSummary: This person may be currently experiencing a lack of resources.\n\nResponse: This person is currently experiencing a lack of resources. First ask about the immediate danger in the situation before asking case-specific questions that suggest solutions. Offer social welfare services and resources attached to shelters and volunteering organizations.\n--\nSummary:  This person may be struggling with addiction.\n\nResponse: This person may be struggling with addiction. Acknowledge and validate their feelings and offer support through mental health services.\n--\nSummary: This person may be struggling with mental health concerns such as depression and/or anxiety.\n\nResponse: This person may be struggling with mental health concerns such as depression and/or anxiety. Reassure them that they are not alone and offer counselling, mental health services, and social services. Offer professional mental health resources (therapy, healthcare provider(s)) and reaching out to trusted individuals.\n--\nSummary:  This person is experiencing a personal crisis.\n\nResponse: This person is experiencing a personal crisis. Acknowledge their feelings of trauma and keep a conversation going. Reassure them that they are not alone. If the crisis involves their immediate health and safety, contact authorities immediately.\n--\nSummary:  This person may be struggling with addiction.\n\nResponse: This person may be struggling with addiction. Acknowledge and validate their feelings and offer support through mental health services.\n--\nSummary:  This person may be struggling with mental health concerns such as depression and/or anxiety.\n\nResponse: This person may be struggling with mental health concerns such as depression and/or anxiety. Listen to their story and reassure them of a kinder future through professional mental health resources (therapy, healthcare provider(s)) and sustainable support groups.\n--\nSummary:  This person may be experiencing emotional distress due to current stress such as financial strain.\n\nResponse: This person may be experiencing emotional distress due to current stress such as financial strain. Try to de-escalate any feelings of fear, anxiety or panic through listening and reassurance. Ensure this person is in immediate safety and offer familial and welfare resources/potential social service help.\n--\nSummary:  This person may be struggling with financial concerns and/or lacking resources.\n\nResponse: This person may be struggling with financial concerns and/or lacking resources. Acknowledge their feelings and be a compassionate listener. Offer social services and welfare resources offered by the general public.\n--\nSummary:  This person may be struggling with mental health concerns such as depression, PTSD and/or anxiety.\n\nResponse: This person may be struggling with mental health concerns such as depression and/or anxiety. Acknowledge their feelings and offer help through professional mental health resources (therapy, healthcare provider(s)). Encourage the person to reach out toward trusted individuals.\n--\nSummary:  This person is experiencing a personal crisis.\n\nResponse: This person is experiencing a personal crisis. Acknowledge their feelings of trauma and keep a conversation going. Reassure them that they are not alone. If the crisis escalates to a point of jeopardizing personal safety, reach out to authorities at 911.\n--\nSummary: This person may be struggling with mental health concerns such as depression and/or anxiety.\n\nResponse: This person may be struggling with mental health concerns such as depression and/or anxiety. Acknowledge their feelings and offer help through professional mental health resources (therapy, healthcare provider(s)). Encourage the person to reach out to trusted individuals.\n--\nSummary: This person is in danger / high risk situation.\n\nResponse: This person may be in danger / high risk situation. Offer help from authorities, trauma centres, abuse helplines, social services; reassure them they are taking the right steps. Contact 911 if suspect of personal safety continues after the conversation.\n--\nSummary: This person may be struggling with alcohol and financial instability.\n\nResponse: This person may be struggling with alcohol and financial instability. First ask about any immediate danger and if illegal substances / harm is in the vicinity.\n--\nSummary: This person may be at risk of domestic violence.\n\nResponse: This person may be at risk of domestic violence. Acknowledge the person’s feelings of injustice and validate their feelings. Aim to calm the person from their emotional distress, and reach out to authorities and seek emergency help if you sense continual danger.\n--\nSummary: This person is undergoing a panic attack.\n\nResponse: This person is undergoing a panic attack. Acknowledge this person’s feelings of panic and have them talk through the state of mind. Try to calm the person from their emotional distress. Continue to reassure this person that they are not alone and connect them with healthcare professionals.\n--\nSummary: This child may be being abused by their parents/guardians.\n\nResponse: This child may be being abused by their parents/guardians. Acknowledge the child’s feelings and refer them to authorities in situations of immediate danger. Offer professional child care and familial resources such as social services.\n--\nSummary: This person is struggling with grief and/or mourning. \n\nResponse: “This person is struggling with grief and/or mourning. Acknowledge the person’s feelings of loss. Offer to help with this person’s feelings in the moment. Be a calming listener and connect them with trusted individuals and supportive groups.\n--\nSummary:   " +
    //   req.body.prompt +
    //   " \n\nResponse:",
    prompt: `Please provide some potential remedies/solutions/guidance to help a person in crisis who has provided this information: "${req.body.prompt}".`,
    max_tokens: 50,
    temperature: 0.5,
    k: 0,
    p: 1,
    frequency_penalty: 0,
    presence_penalty: 0,
    stop_sequences: ["--"],
    return_likelihoods: "NONE",
  });
  res.status(200).json(response);
}
